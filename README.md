# README #

This is a collection of powershell and python scripts to make make AWS/FIleMaker Server devOps a little less painful. These tools are intended to help with the following problems:

* installing letencrypt SSL certificates via WACS
* encrypting FileMaker admin username and password so that we can use various powershell scripts to run as admin without storing sensitive info in cleartext
* dynamically register new IP address with AWS Route53 when the server restarts/reboots
* running S3 sync to backup FileMaker backups and container data

## HOW-TO ##

### WACS Tools ###

WACS (aka Win-ACME) is a program that manages LetsEncrypt certificates on windows like certbot on Linux. Get Win-ACMEv2 for Windows from <https://github.com/PKISharp/win-acme/releases/tag/v2.0.10.> If you haven't already, download and install it; you may need .NET frameworks installed too. You will probably need to restart the EC2 Windows server.

#### Scripts ####

##### SaveFMSCredentials.ps1 #####

Run this to save FileMaker Credentials to an encrypted file object. If no `-filename` or `-path` arguments are found, it will default to the filename, `WacsFMSCreds.xml` and the directory, `C:\ProgramData\win-acme`.

Command:

     SaveFMSCredentials -filename "{filename}" -path "{somepath}" -u "{fmsadminUsername}" -p "{fmsadminPassword}"

Note: Quotes are optional and are used to escape arguments that contain spaces.

Example:
  
     ./SaveFMSCredentials.ps1 -filename fmsSecrets.xml -path C:\mysecrets -u theadminuser -p thepassword

##### InstallSSL.ps1 #####

InstallSSL is a powershell script that imports LetsEncrypt certificates generated by wacs (win-acme) into FileMaker Server 16 and later. It uses the credentials file generated by the `SaveFMSCredentials.ps1` script above to tell perform `fmsadmin` `CERTIFICATE` commands on your behalf.

### Route53 ###

#### Scripts ####

In Progesss

* Updates Route53 DNS
* RefreshR53.ps1
* UpsertR53.ps1

##### Requirements #####

* set up an AWS IAM user
* download Windows AWS Tools
* download Windows AWS CLI Tools
  
#### Known Issues #####

Not tested on MacOS X. May work with tweaks to paths but ymmv.